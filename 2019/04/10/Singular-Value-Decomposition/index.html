<!DOCTYPE html>
<html lang="English">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="DocNan">





<title>Singular Value Decomposition | Hexo</title>



    <link rel="icon" href="../../../../ink_bamboo_1kB.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="../../../../css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="../../../../js/script.js"></script>
    
    <script src="../../../../js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Blog of DocNan</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="../../../../archives">Posts</a>
                
                    <a class="menu-item" href="../../../../Publications">Publications</a>
                
                    <a class="menu-item" href="../../../../category">Categories</a>
                
                    <a class="menu-item" href="../../../../tag">Tags</a>
                
                    <a class="menu-item" href="../../../../about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Blog of DocNan</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="../../../../archives">Posts</a>
                
                    <a class="menu-item" href="../../../../Publications">Publications</a>
                
                    <a class="menu-item" href="../../../../category">Categories</a>
                
                    <a class="menu-item" href="../../../../tag">Tags</a>
                
                    <a class="menu-item" href="../../../../about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Singular Value Decomposition</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">DocNan</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">April 10, 2019&nbsp;&nbsp;15:44:34</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="../../../../Publications/Math/">Math</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>Singular Value Decomposition (SVD) is a powerful method to extract
major components from a matrix of data. It will decompose a signal into
major components and help you to extract the key issue that matters.</p>
<h1 id="principle-of-svd">Principle of SVD</h1>
<p>Suppose we have a signal array matrix as: <span
class="math inline">\(M_{n,m}\)</span>, where n is time dimension, m is
space dimension. After SVD to this signal matrix, it will be decomposed
as the matrix product of three matrix as:</p>
<p><span class="math display">\[
    M_{n,m} = U_{n,n}S_{n,m}V_{m,m}^T
\]</span></p>
<p>Where <span class="math inline">\(U_{n,n}\)</span> is time eigen
vector, <span class="math inline">\(V_{m,m}\)</span> is space eigen
vector. The surffix T stand for matrix transposition. <span
class="math inline">\(S_{n,m}\)</span> is the matrix containing the
eigenvalues. In python and matlab, the singular values and related
singular matrices are arranged by their values from big to small. To
examine the time and space property of a certain singular value <span
class="math inline">\(\lambda_i\)</span>, we can pick up the <span
class="math inline">\(i^{th}\)</span> component in the eigen time and
space vector. Then we perform a Fourier time transformation to the eigen
time vector and get the frequency spectrum of the related singular
value. If we plot the space eigen vector in the polar coordinate, we can
get the space mode structure of the related singular value. The detailed
code to calculated these transformation has been uploaded on Github
(https://github.com/DocNan/Python_libs/). The code to conduct the SVD
analysis can be called as: Python_libs.SVD_analysis().</p>
<h1 id="problem-with-equal-singular-values">Problem with Equal Singular
Values?</h1>
<p>When I use singular value decomposition for the test data, what
puzzles me is that for a rotating signal matrix, it will be decomposed
as two static component after SVD. The example signal matrix is generate
like this:</p>
<figure>
<img src="test_singular_values.png" width="350" alt="Singular Values" />
<figcaption aria-hidden="true">Singular Values</figcaption>
</figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mode1: A1=10, f1=300 Hz, n1=3</span><br><span class="line">Mode2: A2=5, f2=800 Hz, n2=0</span><br><span class="line">Mode3: A3=3, f3=500 Hz, n3=2</span><br><span class="line">Sig(t) = A1*cos(2*pi*f1*t + n1*2*pi*(i-1)/N) + A2*cos(2*pi*f2*t + n2*2*pi*(i-1)/N) + A3*cos(2*pi*f3*t + n3*2*pi*(i-1/N)) + noise(t)</span><br><span class="line">N = 35 is number of artificial probes, i is the index of probe in loop calculation.</span><br></pre></td></tr></table></figure>
<p><img src="singular_value_1_2_order_components.png"
alt="1st, 2nd and 3rd components, frequency and structure" />{width=600px
This problem is actually can be explained as the decomposition of
circular polarized rotation wave.</p>
<h1 id="decomposition-of-circular-polarized-light">Decomposition of
Circular Polarized Light</h1>
<p>To understand the decomposition of the circular polarized light, we
can do this inversely by composing two linearly polarized light to a
circular polarized light. Suppose the two polarized lights are:</p>
<p><span class="math display">\[
\begin{array}{l}
Y_1 = cos(\omega t)\vec{e_x}\\
Y_2 = cos(\omega t + \phi)\vec{e_y}\\
\end{array}
\]</span></p>
<p>Then the coupled wave will be: <span class="math inline">\(Y = Y_1 +
Y_2\)</span>, which is equal to the parameter equation:</p>
<p><span class="math display">\[
\begin{array}{l}
x = cos(\omega t)\\
y = cos(\omega t + \phi)
\end{array}
\]</span> Start from the expression of y, we have:</p>
<p><span class="math display">\[
\begin{array}{l}
y = cos(\omega t + \phi) = cos(\omega t)cos(\phi) - sin(\omega
t)sin(\phi)\\
\Rightarrow sin(\omega t)sin(\phi) = cos(\omega t)cos(\phi) - y\\
\Rightarrow sin^2(\omega t) sin^2(\phi) = cos^2(\omega t)cos^2(\phi) -
2cos(\omega t)cos(\phi)y + y^2
\end{array}
\]</span></p>
<p>Consider the fact that <span class="math inline">\(x = cos(\omega
t)\)</span>, then the whole equation becomes:</p>
<p><span class="math display">\[x^2 -2cos(\phi)xy + y^2
-sin^2(\phi)=0\]</span></p>
<p>With <span class="math inline">\(\Delta = (-2cos(\phi))^2 - 4 &lt;
0\)</span>, where <span class="math inline">\(\phi\neq k\phi\)</span>,
the whole equation will be an normal equation of an ellipse. Then if we
look inversely, we can decompose a circular rotation to two orthogonal
linearly polarized light. That is the reason why we have decomposed the
artificial travel/rotating wave into two static linear polarized
harmonics.</p>
<h1 id="formation-of-the-travelingrotation-wavemode">Formation of the
traveling/rotation wave/mode</h1>
<p>So to reconstruct the traveling wave, we just need to combine the two
equal singular values related harmonics together. For the above
simulation, we can get:</p>
<figure>
<img src="test_svd_n3_01st.png" width="300"
alt="Combination of 1st and 2nd singular components" />
<figcaption aria-hidden="true">Combination of 1st and 2nd singular
components</figcaption>
</figure>
<p>From this figure we can see the rotational wave is well reconstructed
with the combination of 1st and 2nd equal singular value related
components. See the shift of phase shift change with time, which
represent mode rotation.</p>
<p>The related open source python SVD code has been upload on Github
at:</p>
<p><a
href="https://github.com/DocNan/Python_libs">https://github.com/DocNan/Python_libs</a></p>
<p>Welcome to visit!</p>
<p>And thanks for the helpful discussion on this problem on ResearchGate
with Ronald Kessel and Francesco Barone.</p>
<p><a
href="https://www.researchgate.net/post/Why_should_SVD_get_two_equal_singular_values_for_a_single_mode">Page
link to ResearchGate Discussion on SVD</a></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>DocNan</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://docnan.github.io/2019/04/10/Singular-Value-Decomposition/">https://docnan.github.io/2019/04/10/Singular-Value-Decomposition/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>我们的梦想是星辰大海！</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="../../../../tags/Signal/"># Signal</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();" target="_blank" rel="noopener">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="../../30/Standing-Wave/">Standing Wave</a>
            
            
            <a class="next" rel="next" href="../../06/Tones-Asian-Languages/">Tones in Asian Languages</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© DocNan | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
