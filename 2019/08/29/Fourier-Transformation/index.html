<!DOCTYPE html>
<html lang="English">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="DocNan">





<title>Fourier Transformation | Hexo</title>



    <link rel="icon" href="../../../../ink_bamboo_1kB.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="../../../../css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="../../../../js/script.js"></script>
    
    <script src="../../../../js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Blog of DocNan</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="../../../../archives">Posts</a>
                
                    <a class="menu-item" href="../../../../Publications">Publications</a>
                
                    <a class="menu-item" href="../../../../category">Categories</a>
                
                    <a class="menu-item" href="../../../../tag">Tags</a>
                
                    <a class="menu-item" href="../../../../about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Blog of DocNan</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="../../../../archives">Posts</a>
                
                    <a class="menu-item" href="../../../../Publications">Publications</a>
                
                    <a class="menu-item" href="../../../../category">Categories</a>
                
                    <a class="menu-item" href="../../../../tag">Tags</a>
                
                    <a class="menu-item" href="../../../../about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Fourier Transformation</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">DocNan</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">August 29, 2019&nbsp;&nbsp;20:50:28</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="../../../../Publications/Math/">Math</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>Fourier transformation is a classical and powerful tool in
mathematics. However, there are also some details need to be given
special attention during the numerical computation.</p>
<h1 id="principle-of-fourier-transformation">Principle of Fourier
transformation</h1>
<p>Fourier transformation is to convert a signal in the time/space
domains <span class="math inline">\(sig(t),\ sig(x)\)</span> to the
domains of frequency or wave number <span class="math inline">\(sig(f),\
sig(k)\)</span>. The Fourier transformation is defined as [1]:</p>
<p><span class="math display">\[
sig(f) = \int sig(t)e^{i\omega t}dt
\]</span> The related inverse Fourier transformation is:</p>
<p><span class="math display">\[
sig(t) = \frac{1}{2\pi}\int sig(\omega)e^{-i\omega t}df
\]</span> Where the signal frequency <span
class="math inline">\(f\)</span> has the relation with the angular
frequency/velocity as <span class="math inline">\(\omega = 2\pi
f\)</span>.</p>
<h2 id="discrete-fourier-transformation">Discrete Fourier
Transformation</h2>
<p>In numerical computation, we must use discrete data, thus we must
convert the analytic Fourier transformation to discrete transformation.
Which is to say, we need to convert the integration to summation as
[2]:</p>
<p><span class="math display">\[
sig_{fk} = \sum_{n=0}^{N-1} sig_{tn}e^{2\pi ikn/N}
\]</span> The related inverse discrete Fourier transformation is: <span
class="math display">\[
sig_{tn} = \frac{1}{N}\sum_{k=0}^{N-1} sig_{fk}e^{-2\pi i kn/N}
\]</span></p>
<h2 id="fast-fourier-transformation-fft">Fast Fourier Transformation
(FFT)</h2>
<p>Fast Fourier Transformation uses a highly efficient approach to
calculate the discrete Fourier transformation. In many programming
language, there are well written FFT module to use, such as matlab,
python and fortran. However, during the calculation of Fourier strength,
careful attention should be given. A standard example is given by matlab
help doc as [3] shows. Among this code example, several key points shall
be noticed.</p>
<ul>
<li><p>average fft amplitude by dividing the length of fft window L
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Y = fft(sig)</span><br><span class="line">P2 = abs(Y/L)</span><br></pre></td></tr></table></figure> This is because the fft approach by default do not normalized
the strength. The raw result is a summation, the longer the nfft window,
the stronger the strength. Thus, we must normalized the frequency
amplitude by dividing the nfft window length [4].</p></li>
<li><p>correct real half frequency amplitude <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">P2 = abs(Y)</span><br><span class="line">P1 = P2(1:L/2+1);</span><br><span class="line">P1(2:end-1) = 2*P1(2:end-1);</span><br></pre></td></tr></table></figure> Since the
positive and negative frequency are joined together in the half positive
strength, we should multiply the non-zero frequency amplitude by 2.
However, the zero frequency component is unique, thus we don't need to
multiply it [3].</p></li>
</ul>
<p>We can review this problem with python code as: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">import numpy</span><br><span class="line">import pylab</span><br><span class="line"></span><br><span class="line">pylab.close(&apos;all&apos;)</span><br><span class="line">pi = numpy.pi</span><br><span class="line"></span><br><span class="line">Fs = 1000</span><br><span class="line">dt = 1.0/Fs</span><br><span class="line">t = numpy.arange(1, 3, dt)</span><br><span class="line">f1 = 50</span><br><span class="line">f2 = 300</span><br><span class="line">sig = 3*numpy.sin(2*pi*f1*t) + 2*numpy.sin(2*pi*f2*t) + 1</span><br><span class="line"></span><br><span class="line">nfft = len(t)</span><br><span class="line">sig_fft = numpy.fft.fft(sig)</span><br><span class="line">sig_fft_full = sig_fft/nfft</span><br><span class="line">f = numpy.linspace(0, Fs/2, numpy.int(nfft/2))</span><br><span class="line">f_just = numpy.append(f, numpy.linspace(-Fs/2, 0, numpy.int(nfft/2)))</span><br><span class="line"></span><br><span class="line"># reconstruct the signal with FFT data</span><br><span class="line">sig_t = numpy.fft.ifft(sig_fft)</span><br><span class="line"></span><br><span class="line"># correct the half spectrum strength</span><br><span class="line">sig_fft_Amp = numpy.abs(sig_fft)/nfft</span><br><span class="line">sig_fft_real = sig_fft_Amp[0: numpy.int(nfft/2)+1]</span><br><span class="line">f_real = numpy.linspace(0, Fs/2, numpy.int(nfft/2)+1)</span><br><span class="line">sig_fft_real[1:numpy.int(nfft/2)] = 2*sig_fft_real[1:numpy.int(nfft/2)]</span><br><span class="line"></span><br><span class="line">pylab.figure(figsize=(6, 6))</span><br><span class="line">ax1=pylab.subplot(3,1,1)</span><br><span class="line">pylab.plot(t, sig, label=&apos;sig(t) orignal&apos;)</span><br><span class="line">pylab.xlabel(&apos;t (s)&apos;)</span><br><span class="line">pylab.xlim([2, 2.1])</span><br><span class="line">pylab.legend(loc=&apos;upper left&apos;, fontsize=10)</span><br><span class="line">pylab.title(&apos;FFT and inverse iFFT&apos;)</span><br><span class="line"></span><br><span class="line">ax2 = pylab.subplot(3,1,2)</span><br><span class="line">pylab.plot(f_just, numpy.abs(sig_fft_full), &apos;--&apos;, markersize=8, color=&apos;blue&apos;, label=&apos;sig(f) spectrum&apos;)</span><br><span class="line">pylab.plot(f_real, sig_fft_real, &apos;o&apos;, color=&apos;red&apos;, label=&apos;real half spectrum&apos;)</span><br><span class="line">pylab.legend(loc=&apos;upper left&apos;, fontsize=10)</span><br><span class="line">pylab.xlabel(&apos;f (Hz)&apos;)</span><br><span class="line">pylab.xlim([-Fs/2, Fs/2])</span><br><span class="line"></span><br><span class="line">ax3 = pylab.subplot(3,1,3)</span><br><span class="line">pylab.plot(t, sig, &apos;--&apos;, color=&apos;blue&apos;, label=&apos;sig(t) original&apos;)</span><br><span class="line">pylab.plot(t, sig_t, &apos;-.&apos;, color=&apos;red&apos;, label=&apos;sig(t) reconstruct&apos;)</span><br><span class="line">pylab.legend(loc=&apos;upper left&apos;, fontsize=10)</span><br><span class="line">pylab.xlabel(&apos;t (s)&apos;)</span><br><span class="line">pylab.xlim([2, 2.1])</span><br><span class="line"></span><br><span class="line">pylab.tight_layout()</span><br><span class="line">ax1.text(2.003, -2.2, &apos;(a)&apos;, fontsize=18, color=&apos;black&apos;)</span><br><span class="line">ax2.text(-Fs/2+30, 0.5, &apos;(b)&apos;, fontsize=18, color=&apos;black&apos;)</span><br><span class="line">ax3.text(2.003, -2.2, &apos;(c)&apos;, fontsize=18, color=&apos;black&apos;)</span><br></pre></td></tr></table></figure> Calculation
result:</p>
<figure>
<img src="fig_test_fft_ifft_correction.png"
alt="FFT, iFFT and amplitude correction" />
<figcaption aria-hidden="true">FFT, iFFT and amplitude
correction</figcaption>
</figure>
<p>In this example, the test signal is: <span
class="math inline">\(sig(t)=3*sin(2*pi*50*t)+2*sin(2*pi*300*t)+1\)</span>,
this means that in the signal the strength of the 50 Hz component is 3,
the amplitude of 300 Hz component is 2, the amplitude of 0 Hz component
is 1. With the above code calculation, we can clearly see that after
correction in the real half spectrum, the amplitude of the frequency
component match to the given signal very well as figure (b) shows. Also
the reconstructed signal matches well with the original signal. After
the normalization, the unit of the spectrum density shall be the same as
the original signal. eg, Bp(t) in Gs, Bp(f) also in Gs.</p>
<h1 id="reference">Reference</h1>
<p>[1]
中科大高数教研室，高等数学导论，中科大出版社，合肥，2008，第三版。</p>
<p>[2] http://mathworld.wolfram.com/DiscreteFourierTransform.html</p>
<p>[3]
https://www.mathworks.com/matlabcentral/answers/102727-why-does-the-example-in-fft-divide-the-fft-result-by-the-length-of-the-signal-and-multiply-the-magni</p>
<p>[4]
https://in.mathworks.com/matlabcentral/answers/345736-why-fft-amplitude-changes-when-the-signal-s-length-changes</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>DocNan</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://docnan.github.io/2019/08/29/Fourier-Transformation/">https://docnan.github.io/2019/08/29/Fourier-Transformation/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>我们的梦想是星辰大海！</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="../../../../tags/Math/"># Math</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();" target="_blank" rel="noopener">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="../../../11/15/recover-hexo/">Recover Hexo</a>
            
            
            <a class="next" rel="next" href="../../../05/28/Alias-Sampling-Effect/">Alias Sampling Effect</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© DocNan | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
