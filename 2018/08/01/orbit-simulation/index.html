<!DOCTYPE html>
<html lang="English">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="DocNan">





<title>Planet Orbit Simulation | Hexo</title>



    <link rel="icon" href="../../../../ink_bamboo_1kB.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="../../../../css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="../../../../js/script.js"></script>
    
    <script src="../../../../js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Blog of DocNan</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="../../../../archives">Posts</a>
                
                    <a class="menu-item" href="../../../../Publications">Publications</a>
                
                    <a class="menu-item" href="../../../../category">Categories</a>
                
                    <a class="menu-item" href="../../../../tag">Tags</a>
                
                    <a class="menu-item" href="../../../../about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Blog of DocNan</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="../../../../archives">Posts</a>
                
                    <a class="menu-item" href="../../../../Publications">Publications</a>
                
                    <a class="menu-item" href="../../../../category">Categories</a>
                
                    <a class="menu-item" href="../../../../tag">Tags</a>
                
                    <a class="menu-item" href="../../../../about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Planet Orbit Simulation</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">DocNan</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">August 1, 2018&nbsp;&nbsp;18:42:10</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="../../../../Publications/Physics/">Physics</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>The simulation of a planet orbits around the Sun is a very good
practice to understand the solution to partial differential
equation.</p>
<h1 id="starting-equation">Starting equation</h1>
<p>The balance between gravity and centrifugal force determines the
orbit of a planet circling around the Sun. Here the most simple but yet
useful Newton's gravitational law in the 2D vector form is used.</p>
<p><span class="math display">\[
m\frac{d^2 \vec{r}}{dt^2} = \vec{F} = -G\frac{Mm\vec{r}}{r^3} =
\left\{
\begin{array}{l}
-G\frac{M m x}{r^3}\vec{e_x}\\
-G\frac{M m y}{r^3}\vec{e_y}\\
\end{array}
\right.
\]</span></p>
<p>Where <span class="math inline">\(r=\sqrt{x^2 + y^2}\)</span>. We
further get the momentum equation as:</p>
<p><span class="math display">\[
\left\{
\begin{array}{l}
\frac{dx}{dt} = V_x \\
\frac{dy}{dt} = V_y \\
\frac{dV_x}{dt} = -G\frac{M x}{r^3} \\
\frac{dV_y}{dt} = -G\frac{M y}{r^3}
\end{array}
\right.
\]</span></p>
<p>Further we discrete the above equations with a forward difference
form.</p>
<p><span class="math display">\[
\left\{
\begin{array}{l}
x2 - x1 = V_{x1} \Delta t \\
y2 - y1 = V_{y1} \Delta t \\
V_{x2} - V_{x1} = -G\frac{M x1}{r^3}\Delta t \\
V_{y2} - V_{y1} = -G\frac{M y1}{r^3}\Delta t
\end{array}
\right.
\]</span></p>
<p>Using the above discrete form, we should be able to use loop to
finish the simulation of planet orbit. Detailed code in python see
here:</p>
<h1 id="orbit-simulation-in-python">Orbit simulation in python</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"># solve the planet orbit equations</span><br><span class="line"># ------ import necessary modules</span><br><span class="line">import pylab</span><br><span class="line">import numpy</span><br><span class="line">import sys</span><br><span class="line">sys.path.append(&apos;../../&apos;)</span><br><span class="line"></span><br><span class="line">from function_lib import plot_lib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pylab.close(&apos;all&apos;)</span><br><span class="line"># ------ define difference form of orbit equations</span><br><span class="line">def orbit_diff(x, y, vx, vy, dt):</span><br><span class="line">    GM = 1</span><br><span class="line">    r = numpy.sqrt(x*x+y*y)</span><br><span class="line">    x1 = x + vx*dt</span><br><span class="line">    y1 = y + vy*dt</span><br><span class="line">    vx1 = vx - GM*x/(r**3)*dt</span><br><span class="line">    vy1 = vy - GM*y/(r**3)*dt</span><br><span class="line">    return x1, y1, vx1, vy1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ------ make a time evolution calculation</span><br><span class="line"># set initial values for these data</span><br><span class="line">t0 = 3</span><br><span class="line">dt = 0.0001</span><br><span class="line">vx0 = 0</span><br><span class="line">vy0 = 1.8*0.7</span><br><span class="line">x0 = 1</span><br><span class="line">y0 = 0</span><br><span class="line"></span><br><span class="line">x = x0</span><br><span class="line">y = y0</span><br><span class="line">vx = vx0</span><br><span class="line">vy = vy0</span><br><span class="line">i = 0</span><br><span class="line">N = 1000000</span><br><span class="line">x_array = numpy.linspace(0, 0, N)</span><br><span class="line">y_array = numpy.linspace(0, 0, N)</span><br><span class="line">t = numpy.linspace(0, 0, N)</span><br><span class="line"></span><br><span class="line">for i in range(0, N) :</span><br><span class="line">    x_array[i] = x</span><br><span class="line">    y_array[i] = y</span><br><span class="line">    x, y, vx, vy = orbit_diff(x, y, vx, vy, dt)</span><br><span class="line">    t[i] = t0 + i*dt</span><br><span class="line">    i = i + 1</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">t_array = numpy.linspace(0, N - 1, N)*dt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ------ plot planet orbit out</span><br><span class="line"># pylab.close()</span><br><span class="line">pylab.figure()</span><br><span class="line">ax = pylab.subplot(111)</span><br><span class="line">pylab.plot(x_array, y_array, &apos;-&apos;, color = &apos;green&apos;, markersize = 3)</span><br><span class="line"># mark the position of sun</span><br><span class="line">pylab.plot(x0, y0, &apos;o&apos;, markersize = 10)</span><br><span class="line">pylab.plot(0, 0, &apos;o r&apos;, markersize = 30)</span><br><span class="line">pylab.legend([&apos;orbit&apos;, &apos;planet&apos;, &apos;Sun&apos;])</span><br><span class="line">pylab.xlabel(&apos;x(A.U)&apos;)</span><br><span class="line">pylab.ylabel(&apos;y(A.U)&apos;)</span><br><span class="line">ymax = numpy.max(numpy.abs(y_array))*1.1</span><br><span class="line">xmax = numpy.max(numpy.abs(x_array))*1.1</span><br><span class="line">pylab.xlim([-xmax, xmax])</span><br><span class="line">pylab.ylim([-ymax, ymax])</span><br><span class="line">plot_lib.single_plot_paras()</span><br><span class="line">ax.set_aspect(&apos;equal&apos;, &apos;box&apos;)</span><br><span class="line">pylab.show()</span><br></pre></td></tr></table></figure>
<p>Simulation result see this figure</p>
<figure>
<img src="planet_orbit.png" alt="Orbit simulation" />
<figcaption aria-hidden="true">Orbit simulation</figcaption>
</figure>
<p>Attention: the choice of dt apparently affect the accuracy of the
orbit simulation. Small dt results in good accuracy but increases the
calculation time.</p>
<h1 id="orbit-of-many-planets">Orbit of many planets</h1>
<p>In a real star system, there might be mnay planets orbiting around a
main star. Thus we should consider the realistic condition of many
planets and even the interaction between the planets should be
considered.</p>
<h2 id="planets-orbiting">2 planets orbiting</h2>
<p>Here we consider the interaction between two planets but still fix
the main star in the system. The forces act on planet 1 and planet 2 are
like this:</p>
<p><span class="math display">\[
\begin{array}{l}
m_1\frac{d^2 \vec{r}}{dt^2} = -G\frac{M m_1\vec{r}}{r^3} -G\frac{m_2
m_1\vec{r_{12}}}{r_{12}^3}\\
m_2\frac{d^2 \vec{R}}{dt^2} = -G\frac{M m_2\vec{R}}{R^3} -G\frac{m_1
m_2\vec{r_{21}}}{r_{21}^3}
\end{array}
\]</span></p>
<p>Then after discretion, we get this form:</p>
<p><span class="math display">\[
\begin{array}{l}
r = \sqrt{x_1^2 + y_1^2}\\
R = \sqrt{X_1^2 + Y_1^2}\\
r12 = \sqrt{(x_1 - X_1)^2 + (y_1 - Y_1)^2}\\
r21 = r12\\
vx2 = vx1 - GM\frac{x1}{r^3} - G m_2\frac{x1 - X1}{r_{12}^3}\Delta t\\
vy2 = vy1 - GM\frac{y1}{r^3} - G m_2\frac{y1 - Y1}{r_{12}^3}\Delta t\\
VX2 = VX2 - GM\frac{X1}{R^3} - G m_1\frac{X1 - x1}{r_{21}^3}\Delta t\\
VY2 = VY2 - GM\frac{Y1}{R^3} - G m_1\frac{Y1 - y1}{r_{21}^3}\Delta t\\
\end{array}
\]</span></p>
<p>Then we translate these equations into python codes as: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">def orbit_diff_2(x, y, vx, vy, X, Y, VX, VY, dt) :</span><br><span class="line">    GM = 1</span><br><span class="line">    Gm1 = 10**-2</span><br><span class="line">    Gm2 = 3*10**-2</span><br><span class="line">    r = numpy.sqrt(x*x + y*y)</span><br><span class="line">    R = numpy.sqrt(X*X + Y*Y)</span><br><span class="line">    r12 = numpy.sqrt((x-X)**2 + (y - Y)**2)</span><br><span class="line">    r21 = r12</span><br><span class="line">    x2 = x + vx*dt</span><br><span class="line">    y2 = y + vy*dt</span><br><span class="line">    X2 = X + VX*dt</span><br><span class="line">    Y2 = Y + VY*dt</span><br><span class="line">    vx2 = vx - GM*x/(r**3)*dt - Gm2*(x - X)/(r12**3)*dt</span><br><span class="line">    vy2 = vy - GM*y/(r**3)*dt - Gm2*(y - Y)/(r12**3)*dt</span><br><span class="line">    VX2 = VX - GM*X/(R**3)*dt - Gm1*(X - x)/(r21**3)*dt</span><br><span class="line">    VY2 = VY - GM*Y/(R**3)*dt - Gm1*(Y - y)/(r21**3)*dt</span><br><span class="line">    return x2, y2, vx2, vy2, X2, Y2, VX2, VY2</span><br><span class="line"># set start position and speed of planet 1</span><br><span class="line">x = x0</span><br><span class="line">y = y0</span><br><span class="line">vx = vx0</span><br><span class="line">vy = vy0</span><br><span class="line">i = 0</span><br><span class="line">N = 1000000</span><br><span class="line">x_array = numpy.linspace(0, 0, N)</span><br><span class="line">y_array = numpy.linspace(0, 0, N)</span><br><span class="line">t = numpy.linspace(0, 0, N)</span><br><span class="line"># set start position and speed of planet 2</span><br><span class="line">X0 = 2</span><br><span class="line">Y0 = 0</span><br><span class="line">X = X0</span><br><span class="line">Y = Y0</span><br><span class="line">VX = 0</span><br><span class="line">VY = 0.9</span><br><span class="line">X_array = numpy.linspace(0, 0, N)</span><br><span class="line">Y_array = numpy.linspace(0, 0, N)</span><br><span class="line"># perform loop simulation</span><br><span class="line">for i in range(0, N) :</span><br><span class="line">    x_array[i] = x</span><br><span class="line">    y_array[i] = y</span><br><span class="line">    X_array[i] = X</span><br><span class="line">    Y_array[i] = Y</span><br><span class="line">    x, y, vx, vy, X, Y, VX, VY = orbit_diff_2(x, y, vx, vy, X, Y, VX, VY, dt)</span><br><span class="line">    i = i + 1</span><br><span class="line">t_array = numpy.linspace(0, N - 1, N)*dt</span><br><span class="line"># ------ plot planets orbit out</span><br><span class="line"># pylab.close()</span><br><span class="line">pylab.figure(figsize = (10, 5))</span><br><span class="line">ax = pylab.subplot(111)</span><br><span class="line">pylab.plot(x_array, y_array, &apos;-&apos;, color = &apos;green&apos;)</span><br><span class="line">pylab.hold(&apos;on&apos;)</span><br><span class="line">pylab.plot(X_array, Y_array,&apos;--&apos;, color = &apos;black&apos;)</span><br><span class="line"># mark the position of sun</span><br><span class="line">pylab.hold(&apos;on&apos;)</span><br><span class="line">pylab.plot(x0, y0, &apos;o&apos;, color = &apos;green&apos;, markersize = 10)</span><br><span class="line">pylab.hold(&apos;on&apos;)</span><br><span class="line">pylab.plot(X0, Y0, &apos;o&apos;, color = &apos;black&apos;, markersize = 15)</span><br><span class="line">pylab.hold(&apos;on&apos;)</span><br><span class="line">pylab.plot(0, 0, &apos;o r&apos;, markersize = 30)</span><br><span class="line">pylab.legend([&apos;orbit 1&apos;, &apos;orbit 2&apos;, &apos;planet 1&apos;, &apos;planet 2&apos;, &apos;Sun&apos;], frameon = &apos;false&apos;)</span><br><span class="line">pylab.xlabel(&apos;x(A.U)&apos;)</span><br><span class="line">pylab.ylabel(&apos;y(A.U)&apos;)</span><br><span class="line">ymax1 = numpy.max(numpy.abs(y_array))*1.1</span><br><span class="line">xmax1 = numpy.max(numpy.abs(x_array))*1.1</span><br><span class="line">ymax2 = numpy.max(numpy.abs(Y_array))*1.1</span><br><span class="line">xmax2 = numpy.max(numpy.abs(X_array))*1.1</span><br><span class="line">Ymax = numpy.max([ymax1, ymax2])</span><br><span class="line">Xmax = numpy.max([xmax1, xmax2])</span><br><span class="line">ylab.xlim([-Xmax, Xmax])</span><br><span class="line">pylab.ylim([-Ymax, Ymax])</span><br><span class="line">plot_lib.single_plot_paras()</span><br><span class="line">ax.set_aspect(&apos;equal&apos;, &apos;box&apos;)</span><br><span class="line">pylab.tight_layout()</span><br><span class="line">pylab.show()</span><br></pre></td></tr></table></figure></p>
<p>Simulation results shows that for planet mass much smaller than the
central star, the interaction between planets rally change their
orbits.</p>
<figure>
<img src="planets_orbit.png" alt="Orbits simulation: GM/Gm1 = 1E6" />
<figcaption aria-hidden="true">Orbits simulation: GM/Gm1 =
1E6</figcaption>
</figure>
<p>For the case when the planet mass is close to the mass of the central
star, the interaction between planets will disturb their orbits.</p>
<figure>
<img src="planets_orbit2.png" alt="Orbit simulation: GM/Gm1 = 1E2" />
<figcaption aria-hidden="true">Orbit simulation: GM/Gm1 =
1E2</figcaption>
</figure>
<h2 id="simulation-of-many-planets">Simulation of many planets</h2>
<p>Under this condition, the interaction between planets will be
replaced by a gravity potential.</p>
<h1
id="newtons-gravitational-force-and-kaplers-law-of-planet-orbit">Newton's
Gravitational Force and Kapler's Law of Planet Orbit</h1>
<p>The above works are just numerical simulations, but the physics
behind it is not understand clearly. Eg, why following the Newton's law,
the simulated planet orbit should be an elliptic? The simulation results
only tells you the resulted orbit is an elliptic but it does not tell
you why the orbit is an elliptic. To solve this puzzle, analytic
analysis of orbit equation should be conducted.</p>
<h2 id="gravitational-force-in-the-polar-coordinate">Gravitational Force
in the polar coordinate</h2>
<p><span class="math display">\[
\frac{d^2\vec{r}}{dt^2} = -GM\frac{\vec{r}}{r^3}
\]</span> Then we apply the polar coordinate with <span
class="math inline">\(\vec{r} = r\vec{e_r}\)</span>, <span
class="math inline">\(\frac{d}{dt}\vec{e_r} =
\frac{d\theta}{dt}\vec{e_{\theta}} = \omega\vec{e_{\theta}}\)</span> and
<span class="math inline">\(\frac{d}{dt}\vec{e_{\theta}} =
-\omega\vec{e_r}\)</span>. With these rules, the vector form of
Gravitation force can be simplified as:</p>
<p><span class="math display">\[
(\frac{d^2 r}{dt^2} - r\omega^2)\vec{e_r} + (2\frac{dr}{dt}\omega +
r\frac{d\omega}{dt})\vec{e_{\theta}} = -GM\frac{1}{r^2}\vec{e_r}
\]</span></p>
<p>The above vector equation can be split in two equations. One in the
radial direction, one in poloidal direction.</p>
<p><span class="math display">\[
\left.
\begin{array}{l l}
\frac{d^2 r}{dt^2} - r\omega^2 = -GM\frac{1}{r^2} &amp;&amp; (a)\\
2\frac{dr}{dt}\omega + r\frac{d\omega}{dt} = 0 &amp;&amp; (b)
\end{array}
\right\} (I)
\]</span></p>
<h2 id="proof-of-kaplers-second-law">Proof of Kapler's Second Law</h2>
<p>From the above equation(b) we can get: <span
class="math inline">\(2\frac{dr}{dt}\omega + r\frac{d\omega}{dt} = 0
\Rightarrow \omega(\omega {dr}{dt} + 2r\frac{d\omega}{dt}) =
\frac{d}{dt}(r^2\omega) = 0\)</span>, which means <span
class="math inline">\(r^2\omega = constant\)</span>. This should be the
proven of Kapler's second law, the sweep area by the line linking the
planet and the Sun is the same in equal time interval, where <span
class="math inline">\(\frac{dS}{dt} = \frac{d(1/2 r^2\omega)}{dt} = 0
\Rightarrow dS/dt = 0\)</span>.</p>
<figure>
<img src="kapler_second.jpg" width="200"
alt="Kapler&#39;s second law, sweep area rule" />
<figcaption aria-hidden="true">Kapler's second law, sweep area
rule</figcaption>
</figure>
<h2 id="proof-of-kaplers-first-law">Proof of Kapler's First Law</h2>
<p>Start from equation I(a), <span class="math inline">\(\frac{d^2
r}{dt^2} - r\omega^2 + GM\frac{1}{r^2} = 0\)</span>. Using the second
law of Kapler <span class="math inline">\(r^2\omega = C\)</span> and
replace <span class="math inline">\(\omega\)</span> with <span
class="math inline">\(r\)</span>, we can get <span
class="math inline">\(\frac{d^2 r}{dt^2} = C\frac{1}{r^3} -
GM\frac{1}{r^2}\)</span>.</p>
<p>If we perform a <span style="color:blue"> smart transform </span> as:
<span style="color:blue"> <span class="math inline">\(\frac{d^2 r}{dt^2}
= \frac{dr}{dt}\frac{d}{dr}(\frac{dr}{dt}) = 1/2
\frac{d}{dr}((\frac{dr}{dt})^2)\)</span> </span>, then equation I(a) can
be rewritten as: <span class="math inline">\(1/2
\frac{d}{dr}((\frac{dr}{dt})^2) = C\frac{1}{r^3} -
GM\frac{1}{r^2}\)</span>.</p>
<p>Perform an integration over r we can further get: <span
class="math inline">\((\frac{dr}{dt})^2 = 2GM\frac{1}{r} -
C\frac{1}{r^2} + D\)</span>.</p>
<p>Then we introduce r as a function of <span
class="math inline">\(\theta\)</span> as <span class="math inline">\(r =
r(\theta)\)</span> and get: <span class="math inline">\(\frac{dr}{dt} =
\frac{dr}{d\theta}\frac{d\theta}{dt} = \omega\frac{dr}{d\theta}\)</span>
and consider Kapler's second law, the previous equation can be rewritten
as: <span class="math inline">\((\frac{dr}{d\theta})^2\frac{C^2}{r^4} =
2GM\frac{1}{r} - C\frac{1}{r^2} + D\)</span>.</p>
<p>Then we introduce a transform as <span class="math inline">\(u = 1/r
\Rightarrow du = \frac{-1}{r^2}dr\)</span> and the previous equation can
be rewrite in this form: <span
class="math inline">\((\frac{du}{d\theta})^2 = A + Bu - Cu^2 \Rightarrow
\frac{du}{d\theta} = \pm \sqrt{A + Bu - Cu^2}\)</span>. It can be easily
found that <span class="math inline">\(\frac{du}{d\theta} &lt;
0\)</span>, which means <span class="math inline">\(\frac{du}{d\theta} =
-\sqrt{A + Bu - Cu^2}\)</span>.</p>
<p>Now we get <span class="math inline">\(\frac{-du}{\sqrt{A + Bu -
Cu^2}}=d\theta \Rightarrow \int\frac{-du}{\sqrt{A + Bu - Cu^2}}=\int
d\theta\)</span>. In the case <span class="math inline">\(\sqrt{A + Bu
-Cu^2} = E\sqrt{1 - (\frac{h - u}{E})^2}\)</span>. Then the function can
be written as: <span class="math inline">\(\int
\frac{d(\frac{h-u}{E})}{\sqrt{1 - (\frac{h - u}{E})^2}} = \int d\theta
\Rightarrow arccos(\frac{h-u}{E}) = \theta + H\)</span>, considering
initial condition we can get <span class="math inline">\(H = 0\)</span>.
Further perform a cos operation on the whole equation we can get:</p>
<p><span class="math inline">\(\frac{h - u}{E} = cos(\theta)\)</span>,
then we replace u with <span class="math inline">\(1/r\)</span> and get:
<span class="math inline">\(r=\frac{1}{h - E cos(\theta)}\)</span> which
is just the equation of elliptic in polar coordinate.</p>
<h2 id="proof-of-kaplers-third-law">Proof of Kapler's Third Law</h2>
<p>Start from equation I(a), <span class="math inline">\(\frac{d^2
r}{dt^2} - r\omega^2 = -GM\frac{1}{r^2}\)</span>, we take an extreme
condition by take the point near the longer leg of the orbit of a
planet, where the change on radius is zero <span
class="math inline">\(\frac{dr}{dt} = 0\)</span>, which will simplify
the above equation as: <span class="math inline">\(- r\omega^2 =
-GM\frac{1}{r^2}\)</span>, then we can get <span
class="math inline">\(r_1^3\omega_1^2 = r_2^3\omega_2^2 = GM \Rightarrow
\frac{R_1^3}{T_1^2} = \frac{R_2^3}{T_2^2} = constant\)</span>, which is
the proof of Kapler's third law. Be careful that this is only an
approximation of the real condition.</p>
<figure>
<img src="kapler_third.jpg" width="200"
alt="Kapler&#39;s third law, period of planets" />
<figcaption aria-hidden="true">Kapler's third law, period of
planets</figcaption>
</figure>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>DocNan</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://docnan.github.io/2018/08/01/orbit-simulation/">https://docnan.github.io/2018/08/01/orbit-simulation/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>我们的梦想是星辰大海！</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="../../../../tags/Physics/"># Physics</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();" target="_blank" rel="noopener">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="../../21/vector-analysis/">Vector Analysis</a>
            
            
            <a class="next" rel="next" href="../../../07/29/magnetic-island/">Magnetic Island</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© DocNan | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
